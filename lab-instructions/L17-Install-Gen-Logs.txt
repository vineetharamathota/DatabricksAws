
  Lab : Install software on Databricks cluster using init script
  ----------------------------------------------------------------
  
 1. Launch databricks workspace.
  
 2. Enable web terminal in your databricks account
  
	Open "Admin Settings" option from Accounts menu (top-right)
	Go to "Workspace Setting" -> Advanced -> Enable 'Web Terminal' toggle.
	Refresh the page.
	
 3. Launch a All-purpose compute cluster. Wait until the cluster is active.
 
	Open the cluster page. 
	 
 4. Click on 'Apps' tab 
 
	Click on 'Web Terminal' button to launch web terminal.	 
	Here we can do any standard operation that are allowed under Ubuntu Linux. 
	
 5. Run the following commands to install 'gen_logs' (a streaming web-logs generator).
 
	sudo su - ubuntu    (sudo as user 'ubuntu') 
	git clone https://github.com/itversity/gen-logs-python3.git
	sudo mv -f gen-logs-python3/gen_logs /opt
	sudo chown -R `whoami` /opt/gen_logs	(make sure the owner is 'ubuntu'. if not, need to change)
	export PATH=$PATH:/opt/gen_logs
	
	start_logs.sh	(run the script to generate logs. Logs are generated into /opt/gen_logs/logs/access.log file
	
	tail_logs.sh	(tail the access.log file)
	
	Click Ctrl+C to terminate the above command.
	
 6. Terminate the cluster.
 
 7. Now, we will launch a new cluster with the above software pre-installed using 'Init Scripts' cluster option
	
	7.1 Create a script file on your local machine called 'install_gen_logs.sh'
	7.2 Add the following lines in the script and save. 
	
		git clone https://github.com/dgadiraju/gen-logs-python3.git
		sudo mv -f gen-logs-python3/gen_logs /opt
		source /opt/gen_logs/start_logs.sh
		
	7.3 Upload the script file to dbfs:/FileStore/scripts folder under DBFS
	
		Open a terminal and activate your Databricks CLI dev-env
		Run the following commands to copy the file
		
			databricks fs mkdirs dbfs:/FileStore/scripts --profile aws
			databricks fs cp ..\install_gen_logs.sh dbfs:/FileStore/scripts --profile aws
			databricks fs ls dbfs:/FileStore/scripts/ --profile aws
			
	7.4 Create a new All-purpose compute cluster and add the Init-script.
	    Go to 'Advanced Options' section and click in 'Init Scripts' tab
		Add as following details:		
			Source: DBFS	
			File path: dbfs:/FileStore/scripts/install_gen_logs.sh
		Click on 'Add' button
		Click on 'Create compute' button to create the cluster.
		
  8. Open the cluster, open the 'Web Terminal' and cleck for the logs
	
		tail_logs.sh
	

	 
 
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  